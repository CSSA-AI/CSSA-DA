
# 📄 中文问答 Chatbot 项目说明与分工（统一数据结构版 | PyTorch + HuggingFace）

---

## 🧠 一、项目概述

本项目旨在构建一个轻量级的中文问答系统（Chatbot），支持用户输入自然语言问题，系统通过语义匹配 + 知识生成方式返回准确答案。

### 🔍 系统核心流程（逻辑简图）：

```
[用户问题]
   ↓
[语义编码（HuggingFace Encoder）]
   ↓
[相似内容检索（向量检索）]
   ↓
[上下文 + 问题送入语言模型（ChatGPT或本地模型）]
   ↓
[生成答案并展示]
```

---

## 🧱 二、统一数据结构（所有模块通用）

### 📄 问答数据条目（统一语料结构）

```json
{
  "id": "00123",
  "question": "如何申请公交卡？",
  "answer": "可通过公交公司官网或窗口办理。",
  "link": "https://city.gov/card",
  "tags": ["交通", "卡证", "政务"]
}
```

| 字段 | 类型 | 说明 |
|------|------|------|
| `id` | str | 唯一标识 |
| `question` | str | 原始提问 |
| `answer` | str | 简洁回答 |
| `link` | str | 原网页参考链接 |
| `tags` | List[str] | 可选，用于分类和过滤 |

### 📐 问题向量表示（HuggingFace + PyTorch）

```python
torch.Tensor of shape (N, D)  # 例如 (500, 768)
```

- 每条问题通过 HuggingFace encoder（如 BERT）转为 D 维张量
- 所有张量可拼接后构建检索索引

### 🔢 检索结果条目

```json
{
  "id": "00123",
  "score": 0.89,
  "question": "如何申请公交卡？",
  "answer": "可通过公交公司官网或窗口办理。",
  "link": "https://city.gov/card"
}
```

---

## 🧩 三、模块分工说明（功能+输入输出）

---

### 🔹模块 1：数据预处理与标准化  
**负责人：A同学**

#### 功能：
- 清洗收集到的原始问答（含网页链接）
- 标准化为统一数据结构（JSON 或 CSV）
- 可增加分词、标签等信息

#### 输入：
- 原始表格（CSV/Excel）

#### 输出：
- `qa_dataset_cleaned.json`

---

### 🔹模块 2：向量编码与索引构建（HuggingFace）  
**负责人：B同学**

#### 功能：
- 使用 HuggingFace encoder（如 `bert-base-chinese`）对所有问题编码
- 输出 PyTorch 张量
- 构建向量索引（可使用 sklearn/FAISS）

#### 输入：
- 清洗后的问答 JSON 数据（Module 1 输出）

#### 输出：
- `qa_tensors.pt`：所有问题张量  
- `id_map.json`：id 对应原始问答  
- 向量索引结构

---

### 🔹模块 3：语义检索系统  
**负责人：C同学**

#### 功能：
- 用户提问 → 使用相同 encoder 生成张量 → 查找最相似的 k 个问答
- 返回含 `question + answer + link` 的上下文块

#### 输入：
- 用户问题（字符串）
- 编码模型 + 索引张量（Module 2 输出）

#### 输出：
- top-k 相关问答条目（含相似度）

---

### 🔹模块 4：回答生成模块  
**负责人：D同学**

#### 功能：
- 构造 prompt 输入 ChatGPT 或本地大语言模型
- 拼接检索到的上下文作为参考资料
- 返回自然语言回答

#### 输入：
- 用户问题
- 检索上下文（Module 3 输出）

#### 输出：
- 生成的回答文本（可附链接）

---

### 🔹模块 5：交互前端（原型）  
**负责人：E同学**

#### 功能：
- 构建用户输入问题的页面（推荐用 Gradio）
- 展示模型生成回答
- 支持历史记录、复制链接等功能

#### 输入：
- 用户问题（来自输入框）
- 模块 4 生成的回答文本

#### 输出：
- 可交互的聊天界面原型

---

## 🧪 四、测试任务建议（所有人适用）

- 提供一份测试用例（用户问题样本 + 输出）
- 明确模块接口函数签名
- 使用 Jupyter Notebook 或 Python 脚本交付
- 所有中间结构使用统一数据格式

---

## ⏳ 五、开发节奏建议

| 周次 | 内容 | 输出 |
|------|------|------|
| 第1周 | 数据处理标准化 | `qa_dataset_cleaned.json` |
| 第2周 | 向量化模型调试 | `qa_tensors.pt` |
| 第3周 | 检索接口对接 | 检索输出 json / print 示例 |
| 第4周 | 回答生成接入 | 回答函数 + prompt 设计 |
| 第5周 | Gradio 页面上线 | 可运行前端页面 |
| 第6周 | 联调展示 + 文档整理 | 项目说明 + 流程打通 |

---

## ✅ 附加说明

- 所有成员使用统一数据格式文件交接（特别是问题张量与 JSON 问答）
- 所有模块保持函数接口清晰，可集成至主程序中
- 项目采用模块驱动开发，最后一周合并
